<?xml version="1.0" encoding="UTF-8"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.05" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="" keyVect="dD7em6BEI+PxAtsQaegODg==" exportKeySalt="07a7cf2c-b368-47d3-831b-a64c2237cec5" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="CleanupOnError" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:24:11.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7484997a-4cf5-4376-9a80-595d8ac61d4d]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="IndGenerateLoad" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndIsHidden" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IsConcurrent" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[24]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[271]]></Field>
	<Field name="ITxtDelTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String">null</Field>
	<Field name="KmLang" type="java.lang.String">null</Field>
	<Field name="KmSrcLang" type="java.lang.String">null</Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String">null</Field>
	<Field name="KmVersion" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:24:11.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="ScOrigTrtTag" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[PRC_INSERT_INTO_XML]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[4903]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[INFA2Paas_OBIEJE_SFDC_LS]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[4902]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[XML_INFA2PaaS_OBIEEXACTLY_LS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[XML]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:24:11.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2635db7e-60e9-4cb7-b61a-f0d936f2773d]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[672]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[271]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:24:11.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[INSERT_DATA_INTO_XML]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[105792d2-35ab-4e7c-8618-05500fc51230]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[4902]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[insert into <%=odiRef.getObjectName("L", "COMPENSATIONPAYMENTS", "XML_INFA2PaaS_OBIEEXACTLY_LS", "D")%> 
(AMOUNT_UNIT_TYPE, AMOUNT_UNIT_TYPEORDER, AMOUNT_USD, AMOUNT_USDORDER, COMPENSATIONPAYMENTSORDER, 
CUSTOMER_NAME, CUSTOMER_NAMEORDER, CUSTOMER_NUMBER, CUSTOMER_NUMBERORDER, GL_APC_CODE, GL_APC_CODEORDER,
ID, IDORDER, LAST_MONTH_DAY, LAST_MONTH_DAYORDER, OBIEJEXACTLYSTAGINGINPUTFK, ORDER_CODE, ORDER_CODEORDER,
PRODUCT_HIERARCHY_FAMILY, PRODUCT_HIERARCHY_FAMILYORDER, PRODUCT_HIERARCHY_LINE, PRODUCT_HIERARCHY_LINEORDER,
PRODUCT_HIERARCHY_SBU, PRODUCT_HIERARCHY_SBUORDER, PRODUCT_HIERARCHY_TECHNOLOGY, PRODUCT_HIERARCHY_TECHNOLOGYORDER,
SOURCE, SOURCEORDER, TYPE_, TYPE_ORDER)
values
(
        :AMOUNT_UNIT_TYPE,
        4,
        :AMOUNT_USD,
        3,
        0,
        :CUSTOMER_NAME,
        7,
        :CUSTOMER_NUMBER,
        6,
        :GL_APC_CODE,
        2,
        0,
        13,
        :LAST_MONTH_DAY,
        5,
        0,
        :ORDER_CODE,
        0,
        :PRODUCT_HIERARCHY_FAMILY,
        9,
        :PRODUCT_HIERARCHY_LINE,
        8,
        :PRODUCT_HIERARCHY_SBU,
        11,
        :PRODUCT_HIERARCHY_TECHNOLOGY,
        10,
        :SOURCE,
        12,
        :TYPE,
        1
)
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Target Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[DEF_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fa6f1145-49f2-4865-93ab-c6dadc9ae49a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[4903]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[SELECT
    --
    T757366.X_MOT_ACCOUNT_CLASS ACCOUNT_CLASS,
    T777852.PER_NAME_MONTH,
    --
    NVL(
        CASE
            WHEN T750045.ACCOUNT_SEG1_CODE IS NULL
            THEN T854409.ACCOUNT_SEG1_CODE
            ELSE T750045.ACCOUNT_SEG1_CODE
        END,
        CASE
           WHEN T854409.ACCOUNT_SEG1_CODE IS NULL
           THEN T750045.ACCOUNT_SEG1_CODE
           ELSE T854409.ACCOUNT_SEG1_CODE
        END
    ) AS GL_LEGAL_ENTITY,
    --
    CASE
        WHEN T750045.ACCOUNT_SEG2_CODE IS NULL
        THEN T854409.ACCOUNT_SEG2_CODE
        ELSE T750045.ACCOUNT_SEG2_CODE
    END AS GL_BUSINESS,
    --
    NVL (
        CASE
            WHEN T750045.ACCOUNT_SEG3_CODE IS NULL
            THEN
                CASE
                    WHEN T757366.X_MOT_ACCOUNT_CLASS IN ('DNAREPT', 'DNARSRV')
                    THEN '410000'
                    ELSE '400000'
               END
            ELSE T750045.ACCOUNT_SEG3_CODE
        END,
        '400000'
    ) AS GL_ACCOUNT_NUMBER,
    --
    CASE
        WHEN T750045.ACCOUNT_SEG4_CODE IS NULL
        THEN T854409.ACCOUNT_SEG4_CODE
        ELSE T750045.ACCOUNT_SEG4_CODE
    END AS GL_DEPARTMENT,
    --
    CASE
        WHEN T750045.ACCOUNT_SEG5_CODE IS NULL
        THEN T854409.ACCOUNT_SEG5_CODE
        ELSE T750045.ACCOUNT_SEG5_CODE
    END AS GL_TYPE_OF_SALE,
    --
    CASE
        WHEN T750045.ACCOUNT_SEG6_CODE IS NULL
        THEN T854409.ACCOUNT_SEG6_CODE
        ELSE T750045.ACCOUNT_SEG6_CODE
    END AS GL_COUNTRY_CODE,
    --
    NVL (
        CASE
            WHEN T750045.ACCOUNT_SEG7_CODE IS NULL
            THEN T854409.ACCOUNT_SEG7_CODE
            ELSE T750045.ACCOUNT_SEG7_CODE
        END,
        CASE
            WHEN T854409.ACCOUNT_SEG7_CODE IS NULL
            THEN T750045.ACCOUNT_SEG7_CODE
            ELSE T854409.ACCOUNT_SEG7_CODE
        END
    ) AS GL_APC_CODE,
    --
    SUM (
        CASE
            WHEN T757366.X_MOT_ACCOUNT_CLASS IN ('ADJ', 'ADJUST')
            THEN T757366.REVENUE_LOC_AMT
            ELSE T757366.X_MOT_REV_EXT_AMT
        END
        * OBAV7_R11_DW.WC_COMMON_PKG.EXCHANGE_RATE(
                           T777852.ENT_PERIOD_END_DT,
                           T757366.LOC_CURR_CODE,
                           'USD'))
        AS AMOUNT_USD,
    --
    SUM (
        CASE
            WHEN T757366.DATASOURCE_NUM_ID IN (51, 52)
            THEN
                CASE
                    WHEN T757366.X_MOT_ACCOUNT_CLASS = 'XLA MANUAL'
                    THEN
                        CASE
                            WHEN T757366.DB_CR_IND = 'DR'
                            THEN NVL (T757366.XACT_QTY, 0) * -1
                            ELSE NVL (T757366.XACT_QTY, 0)
                        END
                     ELSE NVL (T757366.XACT_QTY, 0)
                END
            ELSE
                CASE
                    WHEN T750045.ACCOUNT_SEG3_CODE <> '420000'
                     AND T750045.RECON_TYPE_CODE = 'R'
                     AND T757366.X_MOT_ACCOUNT_CLASS = 'XLA MANUAL'
                    THEN NVL (T757366.XACT_QTY, 0) * -1
                    ELSE NVL (T757366.XACT_QTY, 0)
                END
        END
    ) AS QUANTITY,
    --
    NVL(T734763.NAME, 'ALL_OTHER_CUSTOMERS') AS CUSTOMER_NAME,
    --
    NULLIF((NVL(T734763.ACCOUNT_NUM, 'ALL_OTHER_CUSTOMERS')),
            NVL(T734763.NAME,        'ALL_OTHER_CUSTOMERS')) AS CUSTOMER_NUMBER,
    --
    T1139625.PROD_HIER_APC_CODE AS PRODUCT_HIERARCHY_APC,
    T1139625.PROD_LINE          AS PRODUCT_HIERARCHY_LINE,
    T1139625.PROD_FAMILY        AS PRODUCT_HIERARCHY_FAMILY,
    T1139625.PROD_TECHNOLOGY    AS PRODUCT_HIERARCHY_TECHNOLOGY,
    T1139625.PROD_HIER_SBU      AS PRODUCT_HIERARCHY_SBU
    --
    ,NVL (
        CASE
            WHEN T750045.ACCOUNT_SEG7_CODE IS NULL
            THEN T854409.ACCOUNT_SEG7_CODE
            ELSE T750045.ACCOUNT_SEG7_CODE
        END,
        CASE
            WHEN T854409.ACCOUNT_SEG7_CODE IS NULL
            THEN T750045.ACCOUNT_SEG7_CODE
            ELSE T854409.ACCOUNT_SEG7_CODE
        END
    ) ||'-'||NVL (T734763.ACCOUNT_NUM, 'ALL_OTHER_CUSTOMERS')
      ||'-'|| T757366.X_ARRS_DNA_PERIOD "ORDER_CODE"  
    --
    --,TO_CHAR(LAST_DAY(TO_DATE(T777852.PER_NAME_MONTH||'/01','yyyy/mm/dd')), 'mm/dd/yyyy') LAST_MONTH_DAY
    ,T777852.ENT_PERIOD_END_DT AS LAST_MONTH_DAY  /* JD:  Leverage period end date already captured in W_DAY_D dimension table */
    --
    ,'USD' AS "AMOUNT_UNIT_TYPE"
    ,'Revenue JE' AS "TYPE"
    ,'OBIE' AS "SOURCE"
    ,'a5ca0000000e6UF' AS "LOAD FILE" --Load file record id
   FROM
    --
    OBAV7_R11_DW.W_PARTY_D T733415             /* Dim_W_PARTY_D_Price_List_Customer */
    ,OBAV7_R11_DW.W_CUSTOMER_ACCOUNT_D T734763           /* Dim_W_CUSTOMER_ACCOUNT_D */
    ,OBAV7_R11_DW.W_GL_ACCOUNT_D T750045 /* Dim_W_GL_ACCOUNT_D_Secondary_XLA_Sub_Ledger_Accounting */
    ,OBAV7_R11_DW.W_GL_REVN_F T757366                            /* Fact_W_GL_REVN_F */
    ,OBAV7_R11_DW.W_DAY_D T777852                              /* Dim_W_DAY_D_Common */
    ,OBAV7_R11_DW.W_PRODUCT_D T778402                             /* Dim_W_PRODUCT_D */
    ,OBAV7_R11_DW.W_GL_ACCOUNT_D T854409     /* Dim_W_GL_ACCOUNT_D_Cr_Sec_GL Account */
    ,OBAV7_R11_DW.WC_APC_DH T1139625                                /* Dim_WC_APC_DH */
    --
WHERE 1 = 1
    --
    AND T733415.INTEGRATION_ID = T734763.PARTY_ID
    AND T733415.DATASOURCE_NUM_ID = T734763.DATASOURCE_NUM_ID
    AND T734763.ROW_WID = T757366.CUSTOMER_ACCNT_WID
    AND T750045.ROW_WID = T757366.X_MOT_XLA_SEC_GL_ACCOUNT_WID
    AND T757366.DELETE_FLG = 'N'
    --
    AND T757366.X_MOT_ACCOUNT_CLASS IN (
            'GLADJ','DNAREPT','DNARSRV',
            'EDISC','UNEDISC','MISCCASH')
    -- AND T777852.PER_NAME_MONTH = SUBSTR(T757366.X_ARRS_DNA_PERIOD,1,4) || ' / ' || SUBSTR(T757366.X_ARRS_DNA_PERIOD,5,2)
    AND T777852.ROW_WID = T757366.POSTED_ON_DT_WID  /* JD:  Leverage period end date already captured in W_DAY_D dimension table */
    AND T757366.X_ARRS_DNA_PERIOD = 201711 --Previous month
    AND NVL(T757366.X_MOT_REV_EXT_AMT,0) <> 0
    --
    AND NVL (
         CASE
            WHEN T750045.ACCOUNT_SEG3_CODE IS NULL
            THEN
               CASE
                  WHEN T757366.X_MOT_ACCOUNT_CLASS IN ('DNAREPT', 'DNARSRV')
                  THEN '410000'
                  ELSE '400000'
               END
            ELSE T750045.ACCOUNT_SEG3_CODE
         END,
         '400000') LIKE '4%'
    --
    AND T757366.PRODUCT_WID = T778402.ROW_WID
    AND T757366.POSTED_ON_DT_WID = T777852.ROW_WID
    AND T757366.X_MOT_SEC_COGS_GL_ACCOUNT_WID = T854409.ROW_WID
    AND T757366.X_ARRS_REV_APC_WID = T1139625.ROW_WID
    --
    AND
        NVL (
            CASE
                WHEN T750045.ACCOUNT_SEG7_CODE IS NULL
                THEN T854409.ACCOUNT_SEG7_CODE
                ELSE T750045.ACCOUNT_SEG7_CODE
            END,
            CASE
                WHEN T854409.ACCOUNT_SEG7_CODE IS NULL
                THEN T750045.ACCOUNT_SEG7_CODE
                ELSE T854409.ACCOUNT_SEG7_CODE
            END
        ) NOT IN ('HT01', 'H185', 'H001', 'H950', 'H951', 'HCOM', 'HGPS', 'HNET', 'HWA3', --Corporate
                  'LFRE', 'KFRE', 'AFRE', 'EFRE', '4FRE', 'WFRE', 'SFRE', 'BFRE', 'IFRE') --Freight
    --
--    AND
--        NVL (
--            CASE
--                WHEN T750045.ACCOUNT_SEG7_CODE IS NULL
--                THEN T854409.ACCOUNT_SEG7_CODE
--                ELSE T750045.ACCOUNT_SEG7_CODE
--            END,
--            CASE
--                WHEN T854409.ACCOUNT_SEG7_CODE IS NULL
--                THEN T750045.ACCOUNT_SEG7_CODE
--                ELSE T854409.ACCOUNT_SEG7_CODE
--            END
--        ) NOT IN (SELECT ATTRIBUTE2
--                    FROM OBAV7_R11_DW.WC_FND_LOOKUPS_V_G
--                   WHERE LOOKUP_TYPE = 'C_FND_SALES_COMM_APC_CFG'
--                     AND LANGUAGE = 'US'
--                     AND ENABLED_FLAG = 'Y'
--                     AND SYSDATE BETWEEN NVL (START_DATE_ACTIVE, SYSDATE)
--                                     AND NVL (END_DATE_ACTIVE, SYSDATE + 1)
--                                     AND ATTRIBUTE1 IN ('BOOKED',  'ACTIVE' ))
    --
    /* JD:  Change to NOT EXISTS for better performance */
    AND NOT EXISTS (
        SELECT 1
          FROM OBAV7_R11_DW.WC_FND_LOOKUPS_V_G X
         WHERE X.LOOKUP_TYPE = 'C_FND_SALES_COMM_APC_CFG'
           AND X.LANGUAGE = 'US'
           AND X.ENABLED_FLAG = 'Y'
           AND SYSDATE BETWEEN NVL(X.START_DATE_ACTIVE, SYSDATE)
                           AND NVL(X.END_DATE_ACTIVE, SYSDATE + 1)
           AND X.ATTRIBUTE1 IN ('BOOKED','ACTIVE')
           AND X.ATTRIBUTE2 = NVL(
                   CASE
                        WHEN T750045.ACCOUNT_SEG7_CODE IS NULL
                        THEN T854409.ACCOUNT_SEG7_CODE
                        ELSE T750045.ACCOUNT_SEG7_CODE
                    END,
                    CASE
                        WHEN T854409.ACCOUNT_SEG7_CODE IS NULL
                        THEN T750045.ACCOUNT_SEG7_CODE
                        ELSE T854409.ACCOUNT_SEG7_CODE
                    END
        ))
    --
    /* JD: Exclude this condition as it is causing certain journal entry lines
     * to be excluded from result set. */
    -- AND NULLIF((NVL(T734763.ACCOUNT_NUM, 'ALL_OTHER_CUSTOMERS')),
    --             NVL(T734763.NAME,        'ALL_OTHER_CUSTOMERS')) IS NOT NULL 
    --
GROUP BY
    --
    T757366.X_MOT_ACCOUNT_CLASS,
    T777852.PER_NAME_MONTH,
    --
    --
     (
        CASE
           WHEN T750045.ACCOUNT_SEG1_CODE IS NULL
           THEN T854409.ACCOUNT_SEG1_CODE
           ELSE T750045.ACCOUNT_SEG1_CODE
        END,
        CASE
           WHEN T854409.ACCOUNT_SEG1_CODE IS NULL
           THEN T750045.ACCOUNT_SEG1_CODE
           ELSE T854409.ACCOUNT_SEG1_CODE
        END
    ),
    --
    CASE
        WHEN T750045.ACCOUNT_SEG2_CODE IS NULL
        THEN T854409.ACCOUNT_SEG2_CODE
        ELSE T750045.ACCOUNT_SEG2_CODE
    END,
    --
    NVL (
        CASE
           WHEN T750045.ACCOUNT_SEG3_CODE IS NULL
           THEN
              CASE
                 WHEN T757366.X_MOT_ACCOUNT_CLASS IN ('DNAREPT', 'DNARSRV')
                 THEN '410000'
                 ELSE '400000'
              END
           ELSE T750045.ACCOUNT_SEG3_CODE
        END,
       '400000'
    ),
    --
    CASE
        WHEN T750045.ACCOUNT_SEG4_CODE IS NULL
        THEN T854409.ACCOUNT_SEG4_CODE
        ELSE T750045.ACCOUNT_SEG4_CODE
    END,
   --
    CASE
        WHEN T750045.ACCOUNT_SEG5_CODE IS NULL
        THEN T854409.ACCOUNT_SEG5_CODE
        ELSE T750045.ACCOUNT_SEG5_CODE
    END,
    --
    CASE
        WHEN T750045.ACCOUNT_SEG6_CODE IS NULL
        THEN T854409.ACCOUNT_SEG6_CODE
        ELSE T750045.ACCOUNT_SEG6_CODE
    END,
    --
    NVL (
        CASE
           WHEN T750045.ACCOUNT_SEG7_CODE IS NULL
           THEN T854409.ACCOUNT_SEG7_CODE
           ELSE T750045.ACCOUNT_SEG7_CODE
        END,
        CASE
           WHEN T854409.ACCOUNT_SEG7_CODE IS NULL
           THEN T750045.ACCOUNT_SEG7_CODE
           ELSE T854409.ACCOUNT_SEG7_CODE
        END
    ),
    --
    NVL (T734763.NAME,        'ALL_OTHER_CUSTOMERS'),
    NVL (T734763.ACCOUNT_NUM, 'ALL_OTHER_CUSTOMERS'),
    --
    T1139625.PROD_HIER_APC_CODE,
        T1139625.PROD_LINE,
        T1139625.PROD_FAMILY,
        T1139625.PROD_TECHNOLOGY,
        T1139625.PROD_HIER_SBU,
    --
    NVL (
        CASE
            WHEN T750045.ACCOUNT_SEG7_CODE IS NULL
            THEN T854409.ACCOUNT_SEG7_CODE
            ELSE T750045.ACCOUNT_SEG7_CODE
        END,
        CASE
            WHEN T854409.ACCOUNT_SEG7_CODE IS NULL
            THEN T750045.ACCOUNT_SEG7_CODE
            ELSE T854409.ACCOUNT_SEG7_CODE
        END
    ) ||'-'|| NVL (T734763.ACCOUNT_NUM, 'ALL_OTHER_CUSTOMERS')
      ||'-'|| T757366.X_ARRS_DNA_PERIOD 
    ,T777852.ENT_PERIOD_END_DT  /* JD:  Leverage period end date already captured in W_DAY_D dimension table */
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Source Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[COL_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_FOLDER.24]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ed759131-8eb1-4728-8e64-72511aeb8012]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[INFA2PaaS.OBIE_SFDC_XACTLY_STG]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[9.20]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PROJECT.6]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[adec3252-c826-40a8-8adc-aa8cf1bee5cf]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[INFA2PaaS]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[9]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.4902]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[105792d2-35ab-4e7c-8618-05500fc51230]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.4903]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[fa6f1145-49f2-4865-93ab-c6dadc9ae49a]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.271]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7484997a-4cf5-4376-9a80-595d8ac61d4d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[INFA2PaaS.PRC_INSERT_INTO_XML]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_TRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[9.19]]></Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.05]]></Field>
</Object>
</SunopsisExport>
