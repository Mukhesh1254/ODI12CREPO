<?xml version="1.0" encoding="UTF-8"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.05" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="" keyVect="/e3IgWE7VCTeR7M6Zw6jsw==" exportKeySalt="2acda1e0-60c7-4fee-91ea-173095a62780" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="CleanupOnError" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:31:04.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6cdc6c3e-d950-437f-89d8-1a8bdb7b75d6]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="IndGenerateLoad" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndIsHidden" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IsConcurrent" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[55]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[14]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[454]]></Field>
	<Field name="ITxtDelTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String">null</Field>
	<Field name="KmLang" type="java.lang.String">null</Field>
	<Field name="KmSrcLang" type="java.lang.String">null</Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String">null</Field>
	<Field name="KmVersion" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:31:04.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="ScOrigTrtTag" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[PRC_TEMP_C_APC_REV_CONV_SO_PROD_FIRST_LOAD]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String"><![CDATA[DEV]]></Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5871]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[REV_REC_EFIN_REVREC_LS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:31:04.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f8547dc1-a8ea-4d5e-9404-81dc12b17ae4]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[1131]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[454]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:31:04.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create table TEMP_C_APC_REV_CONV_SO_PRC_LOAD]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[604708c9-6321-42cf-a343-2c26e7e871d0]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5871]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[/* Formatted on 24-Aug-2017 1:40:59 PM (QP5 v5.115.810.9015) */
--Change code for ATR16
--Add last_updated Date as period_date
--Not for REVPRO
--Update cost for kit items
--Added field with null for PROD_HIERARCHY
--UPDATE_RETURN_FLAG null
--Updated query to split prod_hierarchy 
--Updated query to split CUST_SITE_REV_ACCT
Create table temp_c_apc_rev_conv_so_prc_ld as (SELECT   0 id,
         0 RC_ID,
         'SO' TYPE,
         0 upload_id,
         'N' processed_flag,
         0 err_msg,
         'Y' cv_eligible_flag,
         0 batch_id,
         0 book_id,
         hp.party_name cstmr_nm,
         0 disc_adj_flag,
         DECODE (oel.line_category_code,
                 'RETURN', (ordered_quantity * unit_list_price * -1),
                 (ordered_quantity * unit_list_price))
            ext_lst_prc,
         DECODE (oel.line_category_code,
                 'RETURN', (ordered_quantity * unit_selling_price * -1),
                 (ordered_quantity * unit_selling_price))
            ext_sll_prc,
         0 disc_amt,
         0 disc_pct,
         0 ALCTBL_XT_PRC,
         msi.segment1 item_num,
         0 BNDL_CNFG_ID,
         0 ret_qty,
         0 inv_qty,
         oel.ordered_quantity ord_qty,
         0 LT_DEF_ACNT,
         oeh.transactional_curr_code curr,
         sob.currency_code f_cur,
         NVL (
            (SELECT   conversion_rate
               FROM   apps.gl_daily_rates@erprevrec
              WHERE       conversion_type = 'Corporate'
                      AND from_currency = oeh.transactional_curr_code
                      AND to_currency = sob.currency_code
                      AND TRUNC (conversion_date) = trunc (oeh.booked_date)),
            1
         )
         f_ex_rate,
         DECODE (
            sob.currency_code,
            'USD',
            1,
            (SELECT   conversion_rate
               FROM   apps.gl_daily_rates@erprevrec
              WHERE       conversion_type = 'Corporate'
                      AND from_currency = sob.currency_code
                      AND to_currency = 'USD'
                      AND TRUNC (conversion_date) = TRUNC (oeh.booked_date))
         )
         g_ex_rate,
         DECODE (line_category_code, 'RETURN', 'Y', 'N') return_flag,
         0 start_date,
         0 end_date,
         0 duration,
         'N' STANDALONE_FLAG,
         0 stated_flag,
         (SELECT   gcc.CONCATENATED_SEGMENTS
             FROM   apps.gl_code_combinations_kfv@erprevrec gcc
             WHERE   gcc.code_combination_id = hcsu.gl_id_rev)
         DEF_SEGMENTS,
         0 REV_SEGMENTS,
         oettt.NAME atr1,
         'EBSSC' atr2,
         0 atr3,--mc.segment5 atr3,
         oeh.attribute1 atr4,
         0 atr5,--mc.segment6 atr5,
         0 atr6,--mc.segment1 atr6,
         0 atr7,
         0 atr8,
         0 atr9,
         0 atr10,
         (SELECT   al.meaning
            FROM   apps.ar_lookups@erprevrec al
           WHERE   al.lookup_type = 'CUSTOMER_CATEGORY'
                   AND al.lookup_code = hp.category_code)
            atr11,
         hca.sales_channel_code atr12,
         0 atr13,
         hou.legal_entity_id atr14,
         0 atr15,
         DECODE (
            mc.segment3,
            'PRO SERVICES',
            NULL,
            (SELECT   'Y'
               FROM   apps.oe_order_headers_all@erprevrec oeh1,
                      apps.oe_order_lines_all@erprevrec oel1,
                      apps.OE_TRANSACTION_TYPES_ALL@erprevrec oett1,
                      apps.OE_TRANSACTION_TYPES_TL@erprevrec oettt1,
                      apps.MTL_SYSTEM_ITEMS_B@erprevrec msb1
              WHERE   1 = 1 --AND oeh1.OPEN_FLAG = 'Y'
                      AND oeh1.ORDER_TYPE_ID = oett1.TRANSACTION_TYPE_ID
                      AND oett1.TRANSACTION_TYPE_ID =
                            oettt1.TRANSACTION_TYPE_ID
                      AND oettt1.LANGUAGE = 'US'
                      AND oeh1.header_id = oel1.header_id
                      AND oel1.LINE_CATEGORY_CODE = 'RETURN'                      
                      AND (UPPER (oel1.RETURN_REASON_CODE) NOT LIKE '%CREDIT%'
                           AND UPPER (oel1.RETURN_REASON_CODE) NOT LIKE '%REBILL%'
                           AND UPPER (oel1.RETURN_REASON_CODE) NOT LIKE '%CM-OFFER APPROVED%'
                           AND UPPER (oel1.RETURN_REASON_CODE) NOT LIKE '%CO OP ADVERTISING%'
                            AND UPPER (oel1.RETURN_REASON_CODE) NOT LIKE '%VR PROGRAM%'
                            AND  UPPER (oel1.RETURN_REASON_CODE) NOT LIKE 'FINANCE VC REVPRO%')
                      AND (UPPER (oettt1.name) NOT LIKE '%CREDIT AND REBILL%')
                          -- AND UPPER (oettt1.name) NOT LIKE '%REBILL%')
                      AND oettt1.name NOT IN
                               (SELECT   meaning
                                  FROM   apps.FND_LOOKUP_VALUES@erprevrec
                                 WHERE   lookup_type LIKE
                                            'C_DA_ORDER_TYPES_RESTRICT'
                                         AND LANGUAGE = 'US')
                      --Order Type restriction
                      AND oel1.INVENTORY_ITEM_ID = msb1.INVENTORY_ITEM_ID
                      AND oel1.SHIP_FROM_ORG_ID = msb1.ORGANIZATION_ID
                      AND msb1.SEGMENT1 NOT IN
                               (SELECT   ffv.flex_value
                                  FROM   apps.fnd_flex_values@erprevrec ffv, apps.fnd_flex_value_sets@erprevrec ffvs
                                 WHERE   1=1
                                         AND ffv.flex_value_set_id = ffvs.flex_value_set_id
                                         AND ffvs.FLEX_VALUE_SET_NAME = 'CHS_AR_TAX_ITEM'
                               )
                      AND oeh1.order_number = oeh.order_number
                      AND oel1.line_id = oel.line_id)
            )
         atr16,
         0 ATR17,
         0 ATR18,
         0 ATR19,
         0 ATR20,
         0 ATR21,
         0 ATR22,
         0 ATR23,
         0 ATR24,
         0 ATR25,
         0 ATR26,
         0 ATR27,
         0 ATR28,
         0 ATR29,
         0 ATR30,
         0 ATR31,
         0 ATR32,
         0 ATR33,
         0 ATR34,
         0 ATR35,
         0 ATR36,
         0 ATR37,
         0 ATR38,
         0 ATR39,
         0 ATR40,
         0 ATR41,
         0 ATR42,
         0 ATR43,
         0 ATR44,
         0 ATR45,
         0 ATR46,
         0 ATR47,
         0 ATR48,
         0 ATR49,
         0 ATR50,
         0 ATR51,
         0 ATR52,
         0 ATR53,
         0 ATR54,
         0 ATR55,
         0 ATR56,
         0 ATR57,
         0 ATR58,
         0 ATR59,
         0 ATR60,
         0 date1,
         0 date2,
         0 date3,
         0 date4,
         0 date5,
         0 NUM1,
         0 NUM2,
         0 NUM3,
         0 NUM4,
         0 NUM5,
         0 NUM6,
         0 NUM7,
         0 NUM8,
         0 NUM9,
         0 NUM10,
         0 NUM11,
         0 NUM12,
         0 NUM13,
         0 NUM14,
         0 NUM15,
         '1' CLIENT_ID,
         0 CRTD_PRD_ID,
         '0' sec_atr_val,
         0 CRTD_BY,                          --ODI team will pass username.
         SYSDATE CRTD_DT,
         0 UPDT_BY,                          --ODI team will pass username.
         SYSDATE UPDT_DT,
         0 GRP_BY_VAL,
         0 CT_NUM,
         0 CT_LINE_NUM,
         0 CT_LINE_ID,
         0 CT_DATE,
         oeh.order_number so_num,
         oel.line_number || '.' || oel.SHIPMENT_NUMBER so_line_num,
         oel.line_id so_line_id,
         oeh.ordered_date so_date,
         0 INV_NUM,
         0 INV_LINE_NUM,
         0 INV_LINE_ID,
         0 INV_DATE,
         0 ORIG_INV_LINE_ID,
         DECODE (
            oel.item_type_Code,
            'KIT',
            (SELECT   SUM (cst.item_cost)
               FROM   apps.oe_order_lines_all@erprevrec oel1,
                      apps.cst_item_costs@erprevrec cst,
                      apps.cst_cost_types_v@erprevrec ct
              WHERE       1 = 1
                      AND cst.inventory_item_id = oel1.inventory_item_id
                      AND cst.organization_id = oel1.ship_from_org_id
                      AND cst.cost_type_id = ct.cost_type_id
                      AND ct.cost_type = 'Frozen'
                      AND oel1.LINK_TO_LINE_ID = oel.line_id),
            (SELECT   cst.item_cost
               FROM   apps.cst_item_costs@erprevrec cst, apps.cst_cost_types_v@erprevrec ct
              WHERE       cst.inventory_item_id = msi.inventory_item_id
                      AND cst.organization_id = oel.ship_from_org_id
                      ---change on 6/12/2017
                      AND cst.cost_type_id = ct.cost_type_id
                      AND ct.cost_type = 'Frozen')
         )
         * ordered_quantity
         cost_amt,
         (SELECT   gcc.concatenated_segments
             FROM   apps.gl_code_combinations_kfv@erprevrec gcc
             WHERE   gcc.code_combination_id = msi.COST_OF_SALES_ACCOUNT)
         COST_DEF_SEGMENTS,
         0 COST_REV_SEGMENTS,
         1 cost_f_ex_rate,
         DECODE (
            sob.currency_code,
            'USD',
            1,
            (SELECT   conversion_rate
               FROM   apps.gl_daily_rates@erprevrec
              WHERE       conversion_type = 'Corporate'
                      AND from_currency = sob.currency_code
                      AND to_currency = 'USD'
                      AND TRUNC (conversion_date) = TRUNC (oel.pricing_date))
         )
         cost_g_ex_rate,
         sob.currency_code cost_curr,
         oett.invoicing_credit_method_code credit_rule,
         0 COST_TYPE_ID,
         'N' unbill_flag,
         0 TERM,
         0 vc_type_name,
         oel.cust_po_number po_num,
         0 QUOTE_NUM,
         oel.schedule_ship_date schd_ship_dt,
         oel.ACTUAL_SHIPMENT_DATE ship_dt,
         0 SALES_REP_NAME,
         hca.account_number cust_num,
         0 prod_ctgry,
         0 prod_class,-- mc.segment2 prod_class,
         0 prod_fmly,--mc.segment4 prod_fmly,
         0 prod_ln,--mc.segment3 prod_ln,
         hou.NAME business_unit,
         0 CT_MOD_DATE,
         0 PRNT_LN_ID,
         0 PRNT_REF_LN_ID,
         0 COMMENTS,
         'Y' FV_ELIGIBLE_FLAG,
         0 REV_OFFSET_SEGS,
         sob.set_of_books_id sob_id,
         0 FV_DATE,
         0 DEF_OFFSET_SEGS,
         0 ORIG_SO_LINE_ID,
         oel.UNIT_SELLING_PRICE_PER_PQTY UNIT_SELL_PRC,
         oel.UNIT_LIST_PRICE_PER_PQTY UNIT_LIST_PRC,
         0 CV_ELIGIBLE_LVL2_FLAG,
         0 IMPAIRMENT_TYPE,
         0 BNDL_PRNT_ID,
         (SELECT   gcc.segment1
            FROM   apps.gl_code_combinations_kfv@erprevrec gcc
           WHERE   gcc.code_combination_id = hcsu.gl_id_rev)
            Company_code,
         DECODE (oel.CANCELLED_FLAG, 'N', '', 'Y') CANCEL_FLAG,
         0 CONV_WF_FLAG,
         0 CA_ACCOUNT,
         0 CI_ACCOUNT,
         0 AL_ACCOUNT,
         0 AR_ACCOUNT,
         0 CONTRA_AR_ACCT,
         0 PAYABLES_ACCT,
         0 LT_DEF_ADJ_ACCT,
         0 UB_LIAB_ACCT,
         0 IC_ACCOUNT,
         0 VC_FORMULA,
         0 VC_PROCESS_TYPE,
         0 VC_AMT,
         0 VC_QTY,
         'apc.c_apc_rev_interface_line_id.NEXTVAL' INTERFACE_LINE_ID,
         --null interface_line_id,
         0 PROTHEUS_UNI_ID,
         0 EXT_SLL_PRC_EXC,
         0 SLL_PRC_EXC,
         --NULL CREATED_BY,
         --NULL CREATED_DATE,
         --NULL LAST_UPDATED_BY,
         --NULL LAST_UPDATE_DATE,
         0 CONCURRENT_REQUEST_ID,
         0 INTERCOMP_FLAG,
         0 odi_id,
         oel.line_category_code line_categ_code,
         oel.context so_return_context,
         (SELECT   interface_line_attribute6
            FROM   apps.ra_customer_trx_lines_all@erprevrec rctla,
                   apps.ra_customer_trx_all@erprevrec rct
           WHERE       1 = 1
                   AND rct.trx_number = NVL (oel.attribute1, '')
                   --and rct.trx_number=cast(regexp_replace(oel.attribute1, '[^0-9]+', '') as char )
                   AND rct.customer_trx_id = rctla.customer_trx_id
                   AND rctla.line_type = 'LINE'
                   --and rctla.line_number=nvl(oel.attribute12,'')
                   AND rctla.line_number =
                         CAST (
                            REGEXP_REPLACE (oel.attribute12, '[^0-9]+', '') AS char
                         )
                   AND rct.org_id = oel.org_id
                   AND rct.org_id = rctla.org_id
                   AND oel.context = 'RETURN'
                   AND oel.attribute1 IS NOT NULL
                   AND oel.attribute12 IS NOT NULL
                   AND oel.attribute1 NOT IN ('PRE INVOICE')
                   AND oel.line_category_code = 'RETURN')
         so_return_atr2,
         0 cust_site_segment1,
         0 cust_site_segment2,
         0 cust_site_segment3,
         0 cust_site_segment4,
         0 cust_site_segment5,
         0 cust_site_segment6,
         0 cust_site_segment7,
         CASE
            WHEN oel.org_id = 1197     --AND oel.creation_date > '02-JAN-2016'
            THEN
               (SELECT   'Y'
                  FROM   apps.mtl_category_sets@erprevrec mcs,
                         apps.mtl_categories_b@erprevrec mcb,
                         apps.mtl_item_categories@erprevrec mic,
                         apps.c_fnd_lookups_v@erprevrec cfl
                 WHERE       mcs.structure_id = mcb.structure_id
                         AND mcb.category_id = mic.category_id
                         AND mcs.category_set_id = mic.category_set_id
                         AND mcs.category_set_name = 'PROD HIER'
                         AND mic.organization_id = 102
                         AND mic.inventory_item_id = oel.inventory_item_id
                         AND lookup_type = 'C_FND_PRO_APC_CODES'
                         AND cfl.lookup_code = mcb.segment1)
            ELSE
               NULL
         END
         prof_svcs_flag,
         0 not_for_revpro,
         TRUNC (SYSDATE) period_date,
         0 PROD_HIERARCHY,
         0 UPDATE_RETURN_FLAG,
          mc.CATEGORY_CONCAT_SEGS || '.' || ff.DESCRIPTION PROD_HIER_ITEM, --Add logic in tranfomration layer to split into prod.hie. columns   atr3,5,6,7,class,fami,ln
         (SELECT   gcc.concatenated_Segments
            FROM   apps.gl_code_combinations_kfv@erprevrec gcc,
                   apps.hz_cust_site_uses_all@erprevrec hcsu
           WHERE   gcc.code_combination_id = hcsu.gl_id_rev
                   AND hcsu.site_use_id = oeh.invoice_to_org_id)
            CUST_SITE_REV_ACCT --add logic in transformation layer to split into  columns  cust_site_segment1..7
  FROM   apps.oe_order_headers_all@erprevrec oeh,
         apps.oe_order_lines_all@erprevrec oel,
         apps.oe_transaction_types_all@erprevrec oett,
         apps.oe_transaction_types_tl@erprevrec oettt,
         apps.hr_operating_units@erprevrec hou,
         apps.mtl_categories_v@erprevrec mc,
         apps.mtl_item_categories@erprevrec mic,
         apps.mtl_system_items@erprevrec msi,
         apps.hz_cust_site_uses_all@erprevrec hcsu,
         apps.hz_cust_acct_sites_all@erprevrec hcas,
         apps.hz_cust_accounts@erprevrec hca,
         apps.hz_parties@erprevrec hp,
         apps.gl_sets_of_books@erprevrec sob,
         apps.fnd_flex_values_vl@erprevrec ff,
         apps.FND_FLEX_VALUE_SETS@erprevrec ffvs,
         apps.mtl_category_sets_tl@erprevrec mcst
 WHERE       
         1 = 1
         AND oeh.header_id = oel.header_id
         AND oeh.org_id = oel.org_id
         AND oeh.order_type_id = oett.transaction_type_id
         AND oeh.org_id = oett.org_id
         AND oett.transaction_type_id = oettt.transaction_type_id
         AND oettt.LANGUAGE = 'US'
         AND oeh.org_id = hou.organization_id
         AND msi.inventory_item_id = mic.inventory_item_id
         AND msi.organization_id = mic.organization_id
         AND msi.inventory_item_id = oel.inventory_item_id
         AND msi.organization_id = 102
         AND mc.disable_date IS NULL
         AND mc.category_id = mic.category_id
         AND mc.STRUCTURE_NAME = 'GIC PRODUCT HIERARCHY'
         AND mic.category_set_id = mcst.CATEGORY_SET_ID
         AND mcst.CATEGORY_SET_name='PROD HIER' 
         AND mcst.LANGUAGE='US'
         AND oeh.invoice_to_org_id = hcsu.site_use_id
         AND hcsu.cust_acct_site_id = hcas.cust_acct_site_id
         AND hcas.cust_account_id = hca.cust_account_id
         AND hca.party_id = hp.party_id
         AND hou.set_of_books_id = sob.set_of_books_id
         AND ff.flex_value = mc.segment1
         AND ff.enabled_flag = 'Y'
         AND ff.end_date_active IS NULL         
         AND ff.flex_value_set_id = ffvs.FLEX_VALUE_SET_ID
         AND ffvs.FLEX_VALUE_SET_NAME='MOGL_APC' 
         AND EXISTS
               (SELECT   segment5
                  FROM   apps.gl_code_combinations_kfv@erprevrec gcc
                 WHERE   gcc.code_combination_id = hcsu.gl_id_rev
                         AND gcc.segment5 = '400')
         AND oeh.order_type_id NOT IN
                  (SELECT   oett.transaction_type_id
                     FROM   apps.c_fnd_lookups_v@erprevrec cflv,
                            apps.oe_transaction_types_tl@erprevrec oettt,
                            apps.oe_transaction_types_all@erprevrec oett
                    WHERE   oettt.name LIKE '%' || cflv.meaning || '%'
                            AND oett.transaction_type_id =
                                  oettt.transaction_type_id
                            AND cflv.lookup_type =
                                  'C_ORDER_TYPE_NOTFOR_REVPRO'
                            AND cflv.enabled_flag = 'Y'
                            AND oettt.LANGUAGE = 'US')         
         AND oel.link_to_line_id IS NULL
         AND (oel.open_flag='Y'))--only first time--01-SEP morning.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Target Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[DEF_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String"><![CDATA[DEV]]></Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5872]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[REV_REC_EFIN_REVREC_LS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:31:04.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[19d35f92-929e-4d68-abe2-4fa215912b43]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[1132]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[454]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:31:04.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop table temp_c_apc_rev_conv_so_prc_ld]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ed825ce3-980a-48d3-8fc5-e9b8fd36dae3]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5872]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[drop table temp_c_apc_rev_conv_so_prc_ld]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_FOLDER.55]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[844c581a-20df-40af-866a-e665942a5dcc]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[Rev_Rec_EBS_FIN.REV_REC_SO_PROD]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[15.15]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PROJECT.14]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ea7b999d-939f-4d2a-8711-55cbc5efac9e]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[Rev_Rec_EBS_FIN]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[15]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.5871]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[604708c9-6321-42cf-a343-2c26e7e871d0]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.454]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[6cdc6c3e-d950-437f-89d8-1a8bdb7b75d6]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[Rev_Rec_EBS_FIN.PRC_TEMP_C_APC_REV_CONV_SO_PROD_FIRST_LOAD]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_TRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[15.42]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.5872]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ed825ce3-980a-48d3-8fc5-e9b8fd36dae3]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.102]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.05]]></Field>
</Object>
</SunopsisExport>
