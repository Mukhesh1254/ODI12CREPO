<?xml version="1.0" encoding="UTF-8"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.05" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="" keyVect="dvS6p8fCBiCrK3hqFyJ/0w==" exportKeySalt="aad113f2-0c87-49af-9072-ce8b9bde4a72" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="CleanupOnError" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:27:47.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b6cbb368-981f-498c-9f01-a7ce64a6c4bb]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="IndGenerateLoad" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndIsHidden" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IsConcurrent" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[46]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[391]]></Field>
	<Field name="ITxtDelTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String">null</Field>
	<Field name="KmLang" type="java.lang.String">null</Field>
	<Field name="KmSrcLang" type="java.lang.String">null</Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String">null</Field>
	<Field name="KmVersion" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:27:47.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="ScOrigTrtTag" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[PRC_C_APC_REV_CONV_TEMP_LOAD]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String"><![CDATA[DEV]]></Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5533]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[REV_REC_DBCS_REVREC_LS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:27:48.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e699afa8-afaf-411a-a742-a1529418e53f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[950]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[391]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:27:48.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[DROP TABLE REV_REC_PSFT_TEMP_LOAD]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[353f7236-d905-4aa8-a923-567608243be3]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5533]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[TRUNCATE TABLE REV_REC_PSFT_TEMP_LOAD_B20]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Target Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[DEF_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5535]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[REV_REC_PSREVREC_LS]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String"><![CDATA[DEV]]></Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5534]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[REV_REC_DBCS_REVREC_LS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:27:50.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a0c40372-2487-4c23-a49f-408f97e88275]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[951]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[391]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2020-07-10 20:27:50.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[CREATE TABLE  REV_REC_PSFT_TEMP_LOAD]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7dd5a103-87b9-4d57-b44a-491c8b36bb6a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5534]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[INSERT INTO REV_REC_PSFT_TEMP_LOAD_B20 values (:BUSINESS_UNIT,
:CONTRACT_NUM,
:CONTRACT_LINE_NUM,
:PO_REF, 
:PCD_START_DT,
:PCD_END_DT, 
:PCD_PRODUCT_ID,
:PCD_UNIT_AMT, 
:PCD_QTY, 
:PCD_GROSS_AMT,
:PCD_TS_VSOE_TRACKABLE,
:PCD_PERCENT,
:PCD_TS_PERCENTAGE,
:PCD_AMOUNT,
:PCD_TS_CUST_LEVEL,
:PC_CUST_ID,
:PC_NAME1, 
:TS_ORA_CUST_OSR,
:TS_ORA_ADDR_OSR,
:ADDR_SEQ_NUM_BILL,
:BILL_PLAN_ID, 
:PCD_ACCT_PLAN_ID, 
:PCAL_CURRENCY_CD,
:CURR_CD_PS_TS_BU_TRANSLATE,
:PCAL_DST_USE,
:PCAL_ACCOUNT,
:PRODUCT ,
:INV_PROD_FAM_CD,
:BUSINESS_UNIT_GL,
:TS_EXTERNAL_VALUE, 
:TS_EXTERNAL_VALUE_SUB_STR,
:DATETIME_ADDED,
:LASTUPDDT_SINCE, 
:DST_ID,	  
:PCAL_ACCOUNTING_DT)]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c4c5481c-2bb4-4110-b276-0568977a98a5]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[5535]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[(SELECT DISTINCT A.BUSINESS_UNIT BUSINESS_UNIT,
A.CONTRACT_NUM CONTRACT_NUM,
B.CONTRACT_LINE_NUM CONTRACT_LINE_NUM,
B.PO_REF PO_REF, 
TO_DATE(B.START_DT,'DD-MON-RR HH24:MI:SS') PCD_START_DT,
TO_DATE(B.END_DT,'DD-MON-RR HH24:MI:SS') PCD_END_DT, 
B.PRODUCT_ID PCD_PRODUCT_ID,
B.UNIT_AMT PCD_UNIT_AMT, 
B.QTY PCD_QTY, 
B.GROSS_AMT PCD_GROSS_AMT,
B.TS_VSOE_TRACKABLE PCD_TS_VSOE_TRACKABLE,
B.PERCENT PCD_PERCENT,
B.TS_PERCENTAGE PCD_TS_PERCENTAGE,
B.AMOUNT PCD_AMOUNT,
B.TS_CUST_LEVEL PCD_TS_CUST_LEVEL,
C.CUST_ID PC_CUST_ID,
C.NAME1 PC_NAME1, 
D.TS_ORA_CUST_OSR TS_ORA_CUST_OSR,
D.TS_ORA_ADDR_OSR TS_ORA_ADDR_OSR,
E.ADDR_SEQ_NUM_BILL ADDR_SEQ_NUM_BILL,
E.BILL_PLAN_ID BILL_PLAN_ID, 
B.ACCT_PLAN_ID PCD_ACCT_PLAN_ID, 
F.CURRENCY_CD PCAL_CURRENCY_CD,
H.CURRENCY_CD CURR_CD_PS_TS_BU_TRANSLATE,
F.DST_USE PCAL_DST_USE,
F.ACCOUNT PCAL_ACCOUNT,
F.PRODUCT PRODUCT ,
G.INV_PROD_FAM_CD INV_PROD_FAM_CD,
F.BUSINESS_UNIT_GL BUSINESS_UNIT_GL,
H.TS_EXTERNAL_VALUE TS_EXTERNAL_VALUE, 
DECODE(SUBSTR(H.TS_EXTERNAL_VALUE,1,6),'604868','604000',
                                               '938868','938000',
                                                SUBSTR(H.TS_EXTERNAL_VALUE,1,6)) TS_EXTERNAL_VALUE_SUB_STR,
MAX( TO_CHAR(CAST((I.DATETIME_ADDED) AS TIMESTAMP),'DD-MON-RR HH24:MI:SS')) DATETIME_ADDED,
MAX( TO_CHAR(I.LASTUPDDT_SINCE,'YYYY-MM-DD')) LASTUPDDT_SINCE, 
F.DST_ID DST_ID,	  
TO_DATE(SYSDATE-1,'DD-MON-RR HH24:MI:SS') PCAL_ACCOUNTING_DT
  FROM sysadm.PS_CA_CONTR_HDR A, sysadm.PS_CA_DETAIL B, sysadm.PS_CUSTOMER C, sysadm.PS_TS_CUST_EXT_TBL D, sysadm.PS_CA_BILL_PLAN E, sysadm.PS_CA_ACCTG_LINE F, sysadm.PS_MASTER_ITEM_TBL G, sysadm.PS_TS_BU_TRANSLATE H, sysadm.PS_TS_DAILY_BK_VW I
 WHERE ( A.CA_STATUS = 'ACTIVE'
     AND A.CONTRACT_NUM = B.CONTRACT_NUM
     AND A.SOLD_TO_CUST_ID = C.CUST_ID
     AND C.SETID = D.SETID
     AND B.CA_LINE_STATUS = 'A'
     AND C.CUST_ID = D.CUST_ID
     AND B.CONTRACT_NUM = E.CONTRACT_NUM
     AND B.BILL_PLAN_ID = E.BILL_PLAN_ID
     AND E.ADDR_SEQ_NUM_BILL = D.ADDRESS_SEQ_NUM
     AND B.CONTRACT_NUM = F.CONTRACT_NUM
     AND B.CONTRACT_LINE_NUM = F.CONTRACT_LINE_NUM
     AND B.ACCT_PLAN_ID = F.ACCT_PLAN_ID
     AND B.PRODUCT_ID = G.INV_ITEM_ID
     AND F.DST_USE = 'REV'
     AND A.BUSINESS_UNIT NOT IN ('ASSUR','PSPAN','PFRAN','PUK','PGERM','MPORT','PROSV','PSINT','MAUST','MGERM','ONDMD','ODINT','ASINT','MUK')
     AND F.BUSINESS_UNIT_GL = H.BUSINESS_UNIT
     AND B.END_DT > trunc(SYSDATE-90)
     AND B.CONTRACT_NUM = I.ORDER_NO
     AND B.CONTRACT_LINE_NUM = I.ORDER_INT_LINE_NO )
		AND F.ACCOUNTING_DT = (SELECT MAX( J.ACCOUNTING_DT)
  FROM sysadm.PS_CA_ACCTG_LINE J
  WHERE J.CONTRACT_NUM = F.CONTRACT_NUM
     AND J.CONTRACT_LINE_NUM = F.CONTRACT_LINE_NUM
     AND J.DST_USE = 'REV') 										
GROUP BY  A.BUSINESS_UNIT,  A.CONTRACT_NUM,  B.CONTRACT_LINE_NUM,  B.PO_REF,  TO_DATE(B.START_DT,'DD-MON-RR HH24:MI:SS'),  TO_DATE(B.END_DT,'DD-MON-RR HH24:MI:SS'),  
  B.PRODUCT_ID,  B.UNIT_AMT,  B.QTY,  B.GROSS_AMT,  B.TS_VSOE_TRACKABLE,  B.PERCENT,  B.TS_PERCENTAGE,  B.AMOUNT,  B.TS_CUST_LEVEL,  C.CUST_ID,  
  C.NAME1,  D.TS_ORA_CUST_OSR,  D.TS_ORA_ADDR_OSR,  E.ADDR_SEQ_NUM_BILL,  E.BILL_PLAN_ID,  B.ACCT_PLAN_ID,  F.CURRENCY_CD,  H.CURRENCY_CD,  F.DST_USE,  
  F.ACCOUNT,  F.PRODUCT,  G.INV_PROD_FAM_CD,  F.BUSINESS_UNIT_GL,  H.TS_EXTERNAL_VALUE,F.DST_ID)
  UNION
  (SELECT DISTINCT A.BUSINESS_UNIT BUSINESS_UNIT,
A.CONTRACT_NUM CONTRACT_NUM,
B.CONTRACT_LINE_NUM CONTRACT_LINE_NUM,
B.PO_REF PO_REF, 
TO_DATE(B.START_DT,'DD-MON-RR HH24:MI:SS') PCD_START_DT,
TO_DATE(B.END_DT,'DD-MON-RR HH24:MI:SS') PCD_END_DT, 
B.PRODUCT_ID PCD_PRODUCT_ID,
B.UNIT_AMT PCD_UNIT_AMT, 
B.QTY PCD_QTY, 
B.GROSS_AMT PCD_GROSS_AMT,
B.TS_VSOE_TRACKABLE PCD_TS_VSOE_TRACKABLE,
B.PERCENT PCD_PERCENT,
B.TS_PERCENTAGE PCD_TS_PERCENTAGE,
B.AMOUNT PCD_AMOUNT,
B.TS_CUST_LEVEL PCD_TS_CUST_LEVEL,
C.CUST_ID PC_CUST_ID,
C.NAME1 PC_NAME1, 
D.TS_ORA_CUST_OSR TS_ORA_CUST_OSR,
D.TS_ORA_ADDR_OSR TS_ORA_ADDR_OSR,
E.ADDR_SEQ_NUM_BILL ADDR_SEQ_NUM_BILL,
E.BILL_PLAN_ID BILL_PLAN_ID, 
B.ACCT_PLAN_ID PCD_ACCT_PLAN_ID, 
F.CURRENCY_CD PCAL_CURRENCY_CD,
H.CURRENCY_CD CURR_CD_PS_TS_BU_TRANSLATE,
F.DST_USE PCAL_DST_USE,
F.ACCOUNT PCAL_ACCOUNT,
F.PRODUCT PRODUCT ,
G.INV_PROD_FAM_CD INV_PROD_FAM_CD,
F.BUSINESS_UNIT_GL BUSINESS_UNIT_GL,
H.TS_EXTERNAL_VALUE TS_EXTERNAL_VALUE, 
DECODE(SUBSTR(H.TS_EXTERNAL_VALUE,1,6),'604868','604000',
                                               '938868','938000',
                                                SUBSTR(H.TS_EXTERNAL_VALUE,1,6)) TS_EXTERNAL_VALUE_SUB_STR,
MAX( TO_CHAR(CAST((I.DATETIME_ADDED) AS TIMESTAMP),'DD-MON-RR HH24:MI:SS')) DATETIME_ADDED,
MAX( TO_CHAR(I.LASTUPDDT_SINCE,'YYYY-MM-DD')) LASTUPDDT_SINCE, 
F.DST_ID DST_ID,	  
TO_DATE(SYSDATE,'DD-MON-RR HH24:MI:SS') PCAL_ACCOUNTING_DT
  FROM sysadm.PS_CA_CONTR_HDR A, sysadm.PS_CA_DETAIL B, sysadm.PS_CUSTOMER C, sysadm.PS_TS_CUST_EXT_TBL D, sysadm.PS_CA_BILL_PLAN E, sysadm.PS_CA_ACCTG_LINE F, sysadm.PS_MASTER_ITEM_TBL G, sysadm.PS_TS_BU_TRANSLATE H, sysadm.PS_TS_DAILY_BK_VW I,
  psrevrec.PS_TS_ERROR_REVPRO Z
 WHERE ( A.CA_STATUS = 'ACTIVE'
     AND A.CONTRACT_NUM = B.CONTRACT_NUM
     AND A.SOLD_TO_CUST_ID = C.CUST_ID
     AND C.SETID = D.SETID
     AND B.CA_LINE_STATUS = 'A'
     AND C.CUST_ID = D.CUST_ID
     AND B.CONTRACT_NUM = E.CONTRACT_NUM
     AND B.CONTRACT_NUM = Z.CONTRACT_NUM
     AND B.CONTRACT_LINE_NUM = Z.CONTRACT_LINE_NUM
     AND B.BILL_PLAN_ID = E.BILL_PLAN_ID
     AND E.ADDR_SEQ_NUM_BILL = D.ADDRESS_SEQ_NUM
     AND B.CONTRACT_NUM = F.CONTRACT_NUM
     AND B.CONTRACT_LINE_NUM = F.CONTRACT_LINE_NUM
     AND B.ACCT_PLAN_ID = F.ACCT_PLAN_ID
     AND B.PRODUCT_ID = G.INV_ITEM_ID
     AND F.DST_USE = 'REV'
     AND A.BUSINESS_UNIT NOT IN ('ASSUR','PSPAN','PFRAN','PUK','PGERM','MPORT','PROSV','PSINT','MAUST','MGERM','ONDMD','ODINT','ASINT','MUK')
     AND F.BUSINESS_UNIT_GL = H.BUSINESS_UNIT
     --AND B.END_DT > TO_DATE('2017-08-31','YYYY-MM-DD') 
     --AND B.END_DT > TO_DATE('2015-12-31','YYYY-MM-DD')
     AND B.CONTRACT_NUM = I.ORDER_NO
     AND B.CONTRACT_LINE_NUM = I.ORDER_INT_LINE_NO )
		AND F.ACCOUNTING_DT = (SELECT MAX( J.ACCOUNTING_DT)
  FROM sysadm.PS_CA_ACCTG_LINE J
  WHERE J.CONTRACT_NUM = F.CONTRACT_NUM
     AND J.CONTRACT_LINE_NUM = F.CONTRACT_LINE_NUM
     AND J.DST_USE = 'REV') 										
GROUP BY  A.BUSINESS_UNIT,  A.CONTRACT_NUM,  B.CONTRACT_LINE_NUM,  B.PO_REF,  TO_DATE(B.START_DT,'DD-MON-RR HH24:MI:SS'),  TO_DATE(B.END_DT,'DD-MON-RR HH24:MI:SS'),  
  B.PRODUCT_ID,  B.UNIT_AMT,  B.QTY,  B.GROSS_AMT,  B.TS_VSOE_TRACKABLE,  B.PERCENT,  B.TS_PERCENTAGE,  B.AMOUNT,  B.TS_CUST_LEVEL,  C.CUST_ID,  
  C.NAME1,  D.TS_ORA_CUST_OSR,  D.TS_ORA_ADDR_OSR,  E.ADDR_SEQ_NUM_BILL,  E.BILL_PLAN_ID,  B.ACCT_PLAN_ID,  F.CURRENCY_CD,  H.CURRENCY_CD,  F.DST_USE,  
  F.ACCOUNT,  F.PRODUCT,  G.INV_PROD_FAM_CD,  F.BUSINESS_UNIT_GL,  H.TS_EXTERNAL_VALUE,F.DST_ID)]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Source Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[COL_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_FOLDER.46]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[b2838321-2e6d-4814-9e81-fc18a0600528]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[REV_REC_B2.0.INT608_PSFT_TO_REVPRO]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[12.21]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PROJECT.12]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[61c2fde7-f368-4d5e-8623-9af9142587c3]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[REV_REC_B2.0]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[12]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.5533]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[353f7236-d905-4aa8-a923-567608243be3]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.391]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[b6cbb368-981f-498c-9f01-a7ce64a6c4bb]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[REV_REC_B2.0.PRC_C_APC_REV_CONV_TEMP_LOAD]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_TRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[12.28]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.5534]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7dd5a103-87b9-4d57-b44a-491c8b36bb6a]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.5535]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c4c5481c-2bb4-4110-b276-0568977a98a5]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.102]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.05]]></Field>
</Object>
</SunopsisExport>
